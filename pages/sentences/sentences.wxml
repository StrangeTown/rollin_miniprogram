<!--pages/sentences/sentences.wxml-->
<navigation-bar title="搜索历史" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="all-results-container" style="height: calc(100vh - 140px);">
  <scroll-view show-scrollbar="{{false}}" class="all-results" scroll-y="true" style="height: calc(100vh - 120px);" bindscrolltolower="onScrollToLower">
    <block wx:if="{{allResults.length > 0}}">
      <block wx:for="{{allResults}}" wx:key="index">
        <view class="all-result-item">
          <view class="item-header">
            <view class="history-time">{{item.createdAt}}</view>
            <view class="header-right">
              <view wx:if="{{item.__preset_item}}" class="preset-label">示例</view>
              <image wx:if="{{!item.__preset_item}}" class="more-icon" src="../../assets/images/more_horizontal_filled_icon.svg" bindtap="onMoreClick" data-index="{{index}}"></image>
            </view>
          </view>
          <view class="history-result">{{item.target}}</view>
          <view class="history-input">{{item.content}}</view>
        </view>
      </block>
      <view class="load-more-container">
        <view class="loading-more" wx:if="{{isLoading}}">
          <view class="loading-spinner-small"></view>
          <text class="loading-text-small">加载中...</text>
        </view>
        <view class="no-more" wx:elif="{{!hasMore}}">
          <text class="no-more-text">没有更多数据了</text>
        </view>
      </view>
    </block>
    <block wx:else>
      <view class="empty-state">
        <view class="empty-text">暂无搜索历史</view>
        <view class="empty-tip">开始使用搜索功能来积累你的学习历史吧</view>
      </view>
    </block>
    <view style="height: 60px;"></view>
  </scroll-view>
</view>

<!-- Action Modal -->
<view class="action-modal {{showActionModal ? 'show' : ''}}" bindtap="closeActionModal">
  <view class="action-modal-content" catchtap="stopPropagation">
    <view class="action-item" bindtap="copyItem">
      <image class="action-icon" src="../../assets/images/copy_filled_icon_dark.svg"></image>
      <text class="action-text">复制</text>
    </view>
    <view class="action-item" bindtap="deleteItem">
      <image class="action-icon" src="../../assets/images/delete_filled_icon.svg"></image>
      <text class="action-text">删除</text>
    </view>
  </view>
</view>

<button class="practice-btn" bindtap="goToPractice">去练习</button>