<!--pages/points/points.wxml-->
<navigation-bar title="翻点" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="points-container">
  <view class="points-card">
    <view class="points-header">
      <view class="points-icon">🔹</view>
      <view class="points-title">当前翻点</view>
    </view>
    <view class="points-display">
      <view class="points-content">
        <text class="points-number">{{userPoints}}</text>
        <image 
          src="/assets/images/arrow_counterclockwise_filled_icon.svg" 
          class="refresh-icon {{isRefreshSpinning ? 'spinning' : ''}}" 
          bindtap="onRefreshPoints"
        />
      </view>
    </view>
    <view class="points-subtitle">
      <view class="subtitle-content" bindtap="showPointRules">
        <image src="/assets/images/info_filled_icon.svg" class="subtitle-icon" />
        <text class="subtitle-text">翻点消耗规则</text>
      </view>
    </view>
  </view>
  
  <view class="earn-points-card">
    <view class="earn-header">
      <view class="earn-title">获取更多翻点</view>
      <view class="earn-subtitle">观看完整广告后，可获得翻点奖励</view>
    </view>
    <button class="watch-ad-btn" bindtap="watchAd">
      <view class="btn-content">
        <view class="btn-icon">📺</view>
        <view class="btn-text">观看广告获取翻点</view>
      </view>
    </button>
  </view>

  <view class="share-points-card">
    <view class="share-header">
      <view class="share-title">邀请好友获取翻点</view>
      <view class="share-subtitle">好友通过你的邀请进入小程序后，你将获得翻点奖励</view>
    </view>
    <button class="share-btn" open-type="share">
      <view class="btn-content">
        <view class="btn-icon">👥</view>
        <view class="btn-text">邀请好友</view>
      </view>
    </button>
  </view>

  <view class="points-records-link" bindtap="goToPointsRecords">
    <text class="records-link-text">翻点明细</text>
    <text class="records-link-arrow">→</text>
  </view>
</view>

<!-- Custom Rules Modal -->
<view wx:if="{{showRulesModal}}" class="modal-overlay" bindtap="closeRulesModal">
  <view class="modal-container" catchtap>
    <view class="modal-header">
      <text class="modal-title">翻点消耗规则</text>
    </view>
    <view class="modal-content">
      <view wx:if="{{pointsRules && pointsRules.length > 0}}">
        <view wx:for="{{pointsRules}}" wx:key="index" class="rule-item">
          <text class="rule-text">{{item}}</text>
        </view>
      </view>
      <view wx:else class="no-rules">
        <text class="no-rules-text">暂无翻点规则</text>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-close-btn" bindtap="closeRulesModal">确定</button>
    </view>
  </view>
</view>